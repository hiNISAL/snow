/*
 * @CreateTime: Feb 7, 2018 10:10 AM
 * @Author: NISAL
 * @Contact: 535964903@qq.com
 * @Last Modified By: NISAL
 * @Last Modified Time: Feb 7, 2018 10:10 AM
 * @Description: Modify Here, Please 
 */
function Snow(option){this.wrap=document.createElement("div");this.offset=0;this.createSnowOffset=0;this.clientWidth=document.body.clientWidth;this.clientHeight=document.documentElement.clientHeight;this.count=0;this.isStop=false;this.pause=false;this.color="#fff";this.opacity=1;this.randombase=1500;this.num=8;this.limit=150;this.isOffset=true;this.stay=false;this.stayTime=1500;this.speed=10;this.maxSize=4;this.maxImgSize=30;this.hideType="scale";this.hideDuration=300;this.isOffsetOnTouch=true;this.isPause=true;this.shadow=true;this.shadowColor="#fff";this.shadowBlur=10;this.shadowSize=3;this.zIndex=99999;this.reversionOffset=false;this.css={};this.constrain=false;this.randomColor=false;this.stayedcss={};if(option){this.opacity=option.opacity||this.opacity;this.num=option.num||this.num;this.limit=option.limit||this.limit;this.maxSize=option.maxSize||this.maxSize;this.maxImgSize=option.maxImgSize||this.maxImgSize;this.hideType=option.hideType||this.hideType;this.shadowColor=option.shadowColor||this.shadowColor;this.css=option.css||this.css;this.stayedcss=option.stayedcss||this.stayedcss;if(typeof option.speed==="number"){this.speed=option.speed}if(typeof option.randombase==="number"){this.randombase=option.randombase}if(typeof option.stayTime==="number"){this.stayTime=option.stayTime}if(typeof option.hideDuration==="number"){this.hideDuration=option.hideDuration}if(typeof option.shadowBlur==="number"){this.shadowBlur=option.shadowBlur}if(typeof option.shadowSize==="number"){this.shadowSize=option.shadowSize}if(typeof option.zIndex==="number"){this.zIndex=option.zIndex}if(typeof option.offset==="boolean"){this.isOffset=option.offset}if(typeof option.isOffsetOnTouch==="boolean"){this.isOffsetOnTouch=option.isOffsetOnTouch}if(typeof option.stay==="boolean"){this.stay=option.stay}if(typeof option.isPause==="boolean"){this.isPause=option.isPause}if(typeof option.shadow==="boolean"){this.shadow=option.shadow}if(typeof option.reversionOffset==="boolean"){this.reversionOffset=option.reversionOffset}if(typeof option.constrain==="boolean"){this.constrain=option.constrain}if(typeof option.randomColor==="boolean"){this.randomColor=option.randomColor}if(typeof(option.imgurl)==="string"){this.img=option.imgurl}if(typeof(option.color)==="string"){this.color=option.color}if(typeof(option.cusShadowColor)==="string"){this.cusShadowColor=option.cusShadowColor}if(typeof(option.color)==="string"){this.color=option.color;this.shadowColor=this.color}if(Object.prototype.toString.call(option.imgurl)==="[object Array]"){this.imgLength=option.imgurl.length;this.img=option.imgurl}if(Object.prototype.toString.call(option.color)==="[object Array]"){this.colorLength=option.color.length;this.color=option.color}if(option.beforeCreate){this.beforeCreate=option.beforeCreate}if(option.created){this.created=option.created}if(option.beforeMoving){this.beforeMoving=option.beforeMoving}if(option.afterMoving){this.afterMoving=option.afterMoving}if(option.stoped){this.stoped=option.stoped}if(option.beforeDestroy){this.beforeDestroy=option.beforeDestroy}if(option.destoryed){this.destoryed=option.destoryed}}document.body.appendChild(this.wrap);var _this=this;window.addEventListener("resize",function(){_this.clientWidth=document.body.clientWidth;_this.clientHeight=document.documentElement.clientHeight});if(this.isOffset){window.addEventListener("mousemove",function(e){var xPos=e.clientX/_this.clientWidth;_this.setOffset(xPos)})}if(this.isOffsetOnTouch){window.addEventListener("touchmove",function(e){var touch=e.touches[0];var xPos=touch.pageX/_this.clientWidth;_this.setOffset(xPos)})}window.addEventListener("focus",function(){_this.pause=false});window.addEventListener("blur",function(){_this.pause=true});this.createSnow()}Snow.prototype.setOffset=function(xPos){this.offset=(xPos-0.5)*(xPos>0.35&&xPos<0.65?6:4);if(this.reversionOffset){this.offset=-this.offset}if(xPos>0.3&&xPos<0.7){this.createSnowOffset=0;return}this.createSnowOffset=xPos-0.5>0?-this.clientWidth*0.5:this.clientWidth*0.5};Snow.prototype.createSnow=function(){var _this=this;var timer=setInterval(function(){if(_this.isStop){clearInterval(timer)}if(_this.pause&&_this.isPause){return}for(var i=0;i<(parseInt(Math.random()*_this.num)+1);i++){if(_this.count>_this.limit){return}_this.beforeCreate&&_this.beforeCreate();var snowFlake=document.createElement(_this.img?"img":"div");var size=parseInt(Math.random()*(_this.img?_this.maxImgSize:_this.maxSize))+6;if(_this.img){if(typeof(_this.img)==="string"){snowFlake.setAttribute("src",_this.img)}else{snowFlake.setAttribute("src",_this.img[parseInt(Math.random()*_this.imgLength)])}}snowFlake.style.position="fixed";snowFlake.style.top=-size-(_this.shadow?_this.shadowSize:0)+"px";snowFlake.style.left=parseInt(Math.random()*_this.clientWidth)+_this.createSnowOffset+"px";snowFlake.style.width=size+"px";_this.constrain?"":snowFlake.style.height=size+"px";_this.img?"":snowFlake.style.borderRadius="100%";snowFlake.style.zIndex=_this.zIndex.toString();snowFlake.style.opacity=_this.opacity;
if(!_this.img){if(_this.randomColor){snowFlake.style.backgroundColor="#"+("00000"+(Math.random()*16777216<<0).toString(16)).substr(-6);_this.shadowColor=snowFlake.style.backgroundColor}else{if(typeof(_this.color)==="string"){snowFlake.style.backgroundColor=_this.color}else{snowFlake.style.backgroundColor=_this.color[parseInt(Math.random()*_this.colorLength)];_this.shadowColor=snowFlake.style.backgroundColor}}}_this.img||!_this.shadow?"":snowFlake.style.boxShadow="0 0 "+_this.shadowBlur+"px "+_this.shadowSize+"px "+(_this.cusShadowColor?_this.cusShadowColor:_this.shadowColor);for(var key in _this.css){if(_this.css.hasOwnProperty(key)){snowFlake.style[key]=_this.css[key]}}_this.count++;_this.wrap.appendChild(snowFlake);_this.created&&_this.created(snowFlake);_this.move(snowFlake,Math.random()*1.5-1)}},parseInt(Math.random()*300)+_this.randombase)};Snow.prototype.move=function(ele,thisOffset){var _this=this;var timer=setInterval(function(){if(_this.isStop){clearInterval(timer)}if(_this.pause&&_this.isPause){return}_this.beforeMoving&&_this.beforeMoving(ele);ele.style.top=parseFloat(ele.style.top)+1+"px";_this.afterMoving&&_this.afterMoving(ele);ele.style.left=parseFloat(ele.style.left)+_this.offset+thisOffset+"px";var destoryDistence=_this.stay?_this.clientHeight-parseInt(ele.style.height):_this.clientHeight;destoryDistence=destoryDistence-(_this.shadow?_this.shadowSize:0);if(parseInt(ele.style.top)>destoryDistence){if(_this.stay){clearInterval(timer);_this.stoped&&_this.stoped(ele);for(var key in _this.stayedcss){if(_this.stayedcss.hasOwnProperty(key)){ele.style[key]=_this.stayedcss[key]}}ele.style.transition="all "+(_this.hideDuration/1000)+"s";setTimeout(function(){ele.style.animation=null;_this.hideType==="scale"?ele.style.transform="scale(0, 0)":ele.style.opacity="0";setTimeout(function(){_this.beforeDestroy&&_this.beforeDestroy(ele);_this.wrap.removeChild(ele);_this.destoryed&&_this.destoryed();_this.count--},_this.hideDuration)},_this.stayTime);return}_this.wrap.removeChild(ele);_this.count--;_this.destoryed&&_this.destoryed();clearInterval(timer)}},parseInt(Math.random()*5)+_this.speed)};Snow.prototype.stop=function(){this.isStop=true;this.wrap.parentNode.removeChild(this.wrap)};